Logging to logs/exp2_tv/swdpo_w33/2024-11-26-12-55-58/dpo_2021
Seed:2021
reset state dist uniform
Dataset loaded: ./datasets/exp1.pkl
opt_params: (100, 8) | train_data: (2000, 7) | valid_data: (10000, 7)
Iteration:  0, train_loss:  1.8696, valid_loss:  1.7480, grad_norm :0.9196, param_norm: 1.5704, expected_regret: 3.4389 expected_RLHFobj: 3.8992, reward_accuracy: 0.3800
Iteration:  99, train_loss:  1.0250, valid_loss:  1.0433, grad_norm :0.2735, param_norm: 1.0904, expected_regret: 0.6341 expected_RLHFobj: 0.5040, reward_accuracy: 0.6900
Iteration:  199, train_loss:  1.1709, valid_loss:  1.2001, grad_norm :0.1867, param_norm: 1.1119, expected_regret: 0.2516 expected_RLHFobj: 0.1432, reward_accuracy: 0.7300
Iteration:  299, train_loss:  1.2816, valid_loss:  1.3159, grad_norm :0.1619, param_norm: 1.1350, expected_regret: 0.1450 expected_RLHFobj: 0.1071, reward_accuracy: 0.7500
Iteration:  399, train_loss:  1.3731, valid_loss:  1.4115, grad_norm :0.0414, param_norm: 1.1557, expected_regret: 0.0770 expected_RLHFobj: 0.0978, reward_accuracy: 0.7400
Iteration:  499, train_loss:  1.4476, valid_loss:  1.4877, grad_norm :0.1352, param_norm: 1.1722, expected_regret: 0.0352 expected_RLHFobj: 0.0968, reward_accuracy: 0.7500
Iteration:  599, train_loss:  1.5106, valid_loss:  1.5531, grad_norm :0.1657, param_norm: 1.1865, expected_regret: -0.0003 expected_RLHFobj: 0.0977, reward_accuracy: 0.7500
Iteration:  699, train_loss:  1.5645, valid_loss:  1.6079, grad_norm :0.0931, param_norm: 1.1991, expected_regret: -0.0238 expected_RLHFobj: 0.1025, reward_accuracy: 0.7500
Iteration:  799, train_loss:  1.6073, valid_loss:  1.6535, grad_norm :0.1819, param_norm: 1.2105, expected_regret: -0.0445 expected_RLHFobj: 0.1023, reward_accuracy: 0.7500
Iteration:  899, train_loss:  1.6424, valid_loss:  1.6894, grad_norm :0.2151, param_norm: 1.2170, expected_regret: -0.0599 expected_RLHFobj: 0.1051, reward_accuracy: 0.7500
Iteration:  999, train_loss:  1.6527, valid_loss:  1.7006, grad_norm :0.1044, param_norm: 1.2165, expected_regret: -0.0690 expected_RLHFobj: 0.1047, reward_accuracy: 0.7500
Logging to logs/exp2_tv/swdpo_w33/2024-11-26-12-55-58/dpo_2022
Seed:2022
reset state dist uniform
Dataset loaded: ./datasets/exp1.pkl
opt_params: (100, 8) | train_data: (2000, 7) | valid_data: (10000, 7)
Iteration:  0, train_loss:  1.8646, valid_loss:  1.7773, grad_norm :1.0090, param_norm: 2.0917, expected_regret: 4.2249 expected_RLHFobj: 4.8443, reward_accuracy: 0.3600
Iteration:  99, train_loss:  0.8364, valid_loss:  0.8715, grad_norm :0.6002, param_norm: 1.6535, expected_regret: 1.1427 expected_RLHFobj: 1.0546, reward_accuracy: 0.6300
Iteration:  199, train_loss:  1.0538, valid_loss:  1.0907, grad_norm :0.2438, param_norm: 1.6578, expected_regret: 0.4238 expected_RLHFobj: 0.4305, reward_accuracy: 0.7100
Iteration:  299, train_loss:  1.2002, valid_loss:  1.2399, grad_norm :0.2312, param_norm: 1.6652, expected_regret: 0.2446 expected_RLHFobj: 0.3453, reward_accuracy: 0.7200
Iteration:  399, train_loss:  1.2996, valid_loss:  1.3426, grad_norm :0.1371, param_norm: 1.6708, expected_regret: 0.1529 expected_RLHFobj: 0.3155, reward_accuracy: 0.7300
Iteration:  499, train_loss:  1.3780, valid_loss:  1.4247, grad_norm :0.2465, param_norm: 1.6754, expected_regret: 0.0897 expected_RLHFobj: 0.3013, reward_accuracy: 0.7300
Iteration:  599, train_loss:  1.4562, valid_loss:  1.5054, grad_norm :0.1249, param_norm: 1.6813, expected_regret: 0.0429 expected_RLHFobj: 0.2950, reward_accuracy: 0.7400
Iteration:  699, train_loss:  1.5193, valid_loss:  1.5704, grad_norm :0.1113, param_norm: 1.6845, expected_regret: 0.0095 expected_RLHFobj: 0.2926, reward_accuracy: 0.7300
Iteration:  799, train_loss:  1.5578, valid_loss:  1.6101, grad_norm :0.0766, param_norm: 1.6850, expected_regret: -0.0101 expected_RLHFobj: 0.2906, reward_accuracy: 0.7400
Iteration:  899, train_loss:  1.6016, valid_loss:  1.6558, grad_norm :0.0858, param_norm: 1.6866, expected_regret: -0.0336 expected_RLHFobj: 0.2909, reward_accuracy: 0.7200
Iteration:  999, train_loss:  1.6375, valid_loss:  1.6921, grad_norm :0.0376, param_norm: 1.6859, expected_regret: -0.0469 expected_RLHFobj: 0.2901, reward_accuracy: 0.7300
Logging to logs/exp2_tv/swdpo_w33/2024-11-26-12-55-58/dpo_2023
Seed:2023
reset state dist uniform
Dataset loaded: ./datasets/exp1.pkl
opt_params: (100, 8) | train_data: (2000, 7) | valid_data: (10000, 7)
Iteration:  0, train_loss:  1.2811, valid_loss:  1.3115, grad_norm :0.8122, param_norm: 1.2896, expected_regret: 1.8749 expected_RLHFobj: 2.2820, reward_accuracy: 0.5400
Iteration:  99, train_loss:  1.2608, valid_loss:  1.3011, grad_norm :0.2837, param_norm: 1.1281, expected_regret: 0.1473 expected_RLHFobj: 0.1517, reward_accuracy: 0.7100
Iteration:  199, train_loss:  1.4384, valid_loss:  1.4819, grad_norm :0.1625, param_norm: 1.1604, expected_regret: 0.0351 expected_RLHFobj: 0.1347, reward_accuracy: 0.7500
Iteration:  299, train_loss:  1.5573, valid_loss:  1.6045, grad_norm :0.1908, param_norm: 1.1814, expected_regret: -0.0235 expected_RLHFobj: 0.1366, reward_accuracy: 0.7500
Iteration:  399, train_loss:  1.6299, valid_loss:  1.6803, grad_norm :0.0934, param_norm: 1.1978, expected_regret: -0.0570 expected_RLHFobj: 0.1409, reward_accuracy: 0.7400
Iteration:  499, train_loss:  1.6847, valid_loss:  1.7376, grad_norm :0.1915, param_norm: 1.2103, expected_regret: -0.0784 expected_RLHFobj: 0.1453, reward_accuracy: 0.7300
Iteration:  599, train_loss:  1.7339, valid_loss:  1.7884, grad_norm :0.0930, param_norm: 1.2201, expected_regret: -0.0986 expected_RLHFobj: 0.1485, reward_accuracy: 0.7400
Iteration:  699, train_loss:  1.7412, valid_loss:  1.7966, grad_norm :0.0730, param_norm: 1.2145, expected_regret: -0.1020 expected_RLHFobj: 0.1462, reward_accuracy: 0.7400
Iteration:  799, train_loss:  1.7745, valid_loss:  1.8300, grad_norm :0.0820, param_norm: 1.2172, expected_regret: -0.1121 expected_RLHFobj: 0.1486, reward_accuracy: 0.7500
Iteration:  899, train_loss:  1.7839, valid_loss:  1.8400, grad_norm :0.2106, param_norm: 1.2146, expected_regret: -0.1167 expected_RLHFobj: 0.1477, reward_accuracy: 0.7500
Iteration:  999, train_loss:  1.7865, valid_loss:  1.8437, grad_norm :0.1464, param_norm: 1.2107, expected_regret: -0.1220 expected_RLHFobj: 0.1461, reward_accuracy: 0.7500
Logging to logs/exp2_tv/swdpo_w33/2024-11-26-12-55-58/dpo_2024
Seed:2024
reset state dist uniform
Dataset loaded: ./datasets/exp1.pkl
opt_params: (100, 8) | train_data: (2000, 7) | valid_data: (10000, 7)
Iteration:  0, train_loss:  1.4778, valid_loss:  1.4445, grad_norm :1.0661, param_norm: 1.3655, expected_regret: 3.4721 expected_RLHFobj: 3.7248, reward_accuracy: 0.3500
Iteration:  99, train_loss:  0.9692, valid_loss:  1.0000, grad_norm :0.2132, param_norm: 1.0425, expected_regret: 0.5698 expected_RLHFobj: 0.3020, reward_accuracy: 0.6800
Iteration:  199, train_loss:  1.1629, valid_loss:  1.1956, grad_norm :0.0798, param_norm: 1.0776, expected_regret: 0.2753 expected_RLHFobj: 0.1430, reward_accuracy: 0.7000
Iteration:  299, train_loss:  1.2954, valid_loss:  1.3321, grad_norm :0.1440, param_norm: 1.1075, expected_regret: 0.1490 expected_RLHFobj: 0.1112, reward_accuracy: 0.7200
Iteration:  399, train_loss:  1.3889, valid_loss:  1.4278, grad_norm :0.1972, param_norm: 1.1300, expected_regret: 0.0804 expected_RLHFobj: 0.1039, reward_accuracy: 0.7400
Iteration:  499, train_loss:  1.4534, valid_loss:  1.4967, grad_norm :0.2145, param_norm: 1.1477, expected_regret: 0.0310 expected_RLHFobj: 0.0990, reward_accuracy: 0.7400
Iteration:  599, train_loss:  1.5120, valid_loss:  1.5574, grad_norm :0.1717, param_norm: 1.1621, expected_regret: -0.0005 expected_RLHFobj: 0.1009, reward_accuracy: 0.7400
Iteration:  699, train_loss:  1.5658, valid_loss:  1.6144, grad_norm :0.1141, param_norm: 1.1761, expected_regret: -0.0273 expected_RLHFobj: 0.1037, reward_accuracy: 0.7300
Iteration:  799, train_loss:  1.6085, valid_loss:  1.6579, grad_norm :0.0797, param_norm: 1.1862, expected_regret: -0.0425 expected_RLHFobj: 0.1062, reward_accuracy: 0.7300
Iteration:  899, train_loss:  1.6467, valid_loss:  1.6963, grad_norm :0.1480, param_norm: 1.1957, expected_regret: -0.0579 expected_RLHFobj: 0.1090, reward_accuracy: 0.7500
Iteration:  999, train_loss:  1.6744, valid_loss:  1.7256, grad_norm :0.0617, param_norm: 1.2016, expected_regret: -0.0753 expected_RLHFobj: 0.1096, reward_accuracy: 0.7400
Logging to logs/exp2_tv/swdpo_w33/2024-11-26-12-55-58/dpo_2025
Seed:2025
reset state dist uniform
Dataset loaded: ./datasets/exp1.pkl
opt_params: (100, 8) | train_data: (2000, 7) | valid_data: (10000, 7)
Iteration:  0, train_loss:  1.3547, valid_loss:  1.3096, grad_norm :1.2384, param_norm: 1.7761, expected_regret: 3.8811 expected_RLHFobj: 4.2281, reward_accuracy: 0.3500
Iteration:  99, train_loss:  0.9798, valid_loss:  1.0124, grad_norm :0.1499, param_norm: 1.5615, expected_regret: 0.5502 expected_RLHFobj: 0.4505, reward_accuracy: 0.7100
Iteration:  199, train_loss:  1.2113, valid_loss:  1.2487, grad_norm :0.1237, param_norm: 1.5765, expected_regret: 0.2278 expected_RLHFobj: 0.2919, reward_accuracy: 0.7400
Iteration:  299, train_loss:  1.3568, valid_loss:  1.4002, grad_norm :0.1483, param_norm: 1.5897, expected_regret: 0.1055 expected_RLHFobj: 0.2613, reward_accuracy: 0.7400
Iteration:  399, train_loss:  1.4580, valid_loss:  1.5044, grad_norm :0.1595, param_norm: 1.5984, expected_regret: 0.0381 expected_RLHFobj: 0.2535, reward_accuracy: 0.7400
Iteration:  499, train_loss:  1.5231, valid_loss:  1.5733, grad_norm :0.0573, param_norm: 1.6033, expected_regret: -0.0003 expected_RLHFobj: 0.2507, reward_accuracy: 0.7300
Iteration:  599, train_loss:  1.5783, valid_loss:  1.6301, grad_norm :0.2746, param_norm: 1.6073, expected_regret: -0.0310 expected_RLHFobj: 0.2499, reward_accuracy: 0.7400
Iteration:  699, train_loss:  1.6395, valid_loss:  1.6926, grad_norm :0.1571, param_norm: 1.6104, expected_regret: -0.0528 expected_RLHFobj: 0.2518, reward_accuracy: 0.7400
Iteration:  799, train_loss:  1.6716, valid_loss:  1.7280, grad_norm :0.1406, param_norm: 1.6115, expected_regret: -0.0739 expected_RLHFobj: 0.2507, reward_accuracy: 0.7400
Iteration:  899, train_loss:  1.7071, valid_loss:  1.7643, grad_norm :0.0969, param_norm: 1.6134, expected_regret: -0.0891 expected_RLHFobj: 0.2522, reward_accuracy: 0.7500
Iteration:  999, train_loss:  1.7411, valid_loss:  1.7991, grad_norm :0.0616, param_norm: 1.6136, expected_regret: -0.0994 expected_RLHFobj: 0.2532, reward_accuracy: 0.7500
Logging to logs/exp2_tv/nsdpo_g0.3/2024-11-26-12-56-25/dpo_2021
Seed:2021
reset state dist uniform
Dataset loaded: ./datasets/exp1.pkl
opt_params: (100, 8) | train_data: (2000, 7) | valid_data: (10000, 7)
Iteration:  0, train_loss:  1.9882, valid_loss:  1.8580, grad_norm :0.0394, param_norm: 1.6364, expected_regret: 3.3565 expected_RLHFobj: 3.8812, reward_accuracy: 0.3900
Iteration:  99, train_loss:  1.5164, valid_loss:  1.4692, grad_norm :0.0158, param_norm: 1.3469, expected_regret: 2.2349 expected_RLHFobj: 2.6045, reward_accuracy: 0.5000
Iteration:  199, train_loss:  1.5254, valid_loss:  1.5040, grad_norm :0.0109, param_norm: 1.3293, expected_regret: 1.6675 expected_RLHFobj: 2.0618, reward_accuracy: 0.5900
Iteration:  299, train_loss:  1.3962, valid_loss:  1.3948, grad_norm :0.0000, param_norm: 1.2596, expected_regret: 1.3395 expected_RLHFobj: 1.6489, reward_accuracy: 0.6300
Iteration:  399, train_loss:  1.4109, valid_loss:  1.4137, grad_norm :0.1115, param_norm: 1.2467, expected_regret: 1.1116 expected_RLHFobj: 1.4135, reward_accuracy: 0.6500
Iteration:  499, train_loss:  1.3796, valid_loss:  1.3882, grad_norm :0.0077, param_norm: 1.2242, expected_regret: 0.9659 expected_RLHFobj: 1.2393, reward_accuracy: 0.6600
Iteration:  599, train_loss:  1.3606, valid_loss:  1.3741, grad_norm :0.0017, param_norm: 1.2091, expected_regret: 0.8627 expected_RLHFobj: 1.1007, reward_accuracy: 0.6600
Iteration:  699, train_loss:  1.4133, valid_loss:  1.4271, grad_norm :0.0056, param_norm: 1.2178, expected_regret: 0.7504 expected_RLHFobj: 1.0176, reward_accuracy: 0.6700
Iteration:  799, train_loss:  1.3854, valid_loss:  1.4042, grad_norm :0.0001, param_norm: 1.2034, expected_regret: 0.6701 expected_RLHFobj: 0.9041, reward_accuracy: 0.6700
Iteration:  899, train_loss:  1.3847, valid_loss:  1.4060, grad_norm :0.0070, param_norm: 1.2011, expected_regret: 0.6216 expected_RLHFobj: 0.8437, reward_accuracy: 0.6600
Iteration:  999, train_loss:  1.3728, valid_loss:  1.3979, grad_norm :0.0019, param_norm: 1.1951, expected_regret: 0.5655 expected_RLHFobj: 0.7597, reward_accuracy: 0.6300
Logging to logs/exp2_tv/nsdpo_g0.3/2024-11-26-12-56-25/dpo_2022
Seed:2022
reset state dist uniform
Dataset loaded: ./datasets/exp1.pkl
opt_params: (100, 8) | train_data: (2000, 7) | valid_data: (10000, 7)
Iteration:  0, train_loss:  1.9393, valid_loss:  1.8455, grad_norm :0.1222, param_norm: 2.1345, expected_regret: 4.2388 expected_RLHFobj: 4.8905, reward_accuracy: 0.3400
Iteration:  99, train_loss:  1.3743, valid_loss:  1.3271, grad_norm :0.0513, param_norm: 1.8688, expected_regret: 3.2221 expected_RLHFobj: 3.6948, reward_accuracy: 0.3900
Iteration:  199, train_loss:  1.1503, valid_loss:  1.1366, grad_norm :0.0283, param_norm: 1.7776, expected_regret: 2.6840 expected_RLHFobj: 3.0250, reward_accuracy: 0.4700
Iteration:  299, train_loss:  1.1293, valid_loss:  1.1356, grad_norm :0.0178, param_norm: 1.7575, expected_regret: 2.1044 expected_RLHFobj: 2.4286, reward_accuracy: 0.5100
Iteration:  399, train_loss:  1.1379, valid_loss:  1.1557, grad_norm :0.0243, param_norm: 1.7477, expected_regret: 1.6782 expected_RLHFobj: 2.0066, reward_accuracy: 0.5700
Iteration:  499, train_loss:  1.1144, valid_loss:  1.1415, grad_norm :0.0021, param_norm: 1.7344, expected_regret: 1.4324 expected_RLHFobj: 1.7351, reward_accuracy: 0.5900
Iteration:  599, train_loss:  1.1383, valid_loss:  1.1686, grad_norm :0.0012, param_norm: 1.7310, expected_regret: 1.2115 expected_RLHFobj: 1.5137, reward_accuracy: 0.6200
Iteration:  699, train_loss:  1.1484, valid_loss:  1.1826, grad_norm :0.0245, param_norm: 1.7273, expected_regret: 1.0539 expected_RLHFobj: 1.3508, reward_accuracy: 0.6400
Iteration:  799, train_loss:  1.1660, valid_loss:  1.2025, grad_norm :0.0026, param_norm: 1.7265, expected_regret: 0.9117 expected_RLHFobj: 1.2051, reward_accuracy: 0.6400
Iteration:  899, train_loss:  1.2058, valid_loss:  1.2435, grad_norm :0.0215, param_norm: 1.7301, expected_regret: 0.7916 expected_RLHFobj: 1.1039, reward_accuracy: 0.6400
Iteration:  999, train_loss:  1.2400, valid_loss:  1.2791, grad_norm :0.0059, param_norm: 1.7336, expected_regret: 0.6978 expected_RLHFobj: 1.0229, reward_accuracy: 0.6400
Logging to logs/exp2_tv/nsdpo_g0.3/2024-11-26-12-56-25/dpo_2023
Seed:2023
reset state dist uniform
Dataset loaded: ./datasets/exp1.pkl
opt_params: (100, 8) | train_data: (2000, 7) | valid_data: (10000, 7)
Iteration:  0, train_loss:  1.3642, valid_loss:  1.3864, grad_norm :0.0150, param_norm: 1.3274, expected_regret: 1.9116 expected_RLHFobj: 2.3642, reward_accuracy: 0.5400
Iteration:  99, train_loss:  1.3575, valid_loss:  1.3993, grad_norm :0.0062, param_norm: 1.2647, expected_regret: 0.7764 expected_RLHFobj: 1.1544, reward_accuracy: 0.6500
Iteration:  199, train_loss:  1.4312, valid_loss:  1.4719, grad_norm :0.0086, param_norm: 1.2700, expected_regret: 0.5851 expected_RLHFobj: 0.9754, reward_accuracy: 0.6600
Iteration:  299, train_loss:  1.4667, valid_loss:  1.5091, grad_norm :0.0000, param_norm: 1.2713, expected_regret: 0.4695 expected_RLHFobj: 0.8463, reward_accuracy: 0.6800
Iteration:  399, train_loss:  1.4607, valid_loss:  1.5073, grad_norm :0.0080, param_norm: 1.2649, expected_regret: 0.3810 expected_RLHFobj: 0.7072, reward_accuracy: 0.6700
Iteration:  499, train_loss:  1.4759, valid_loss:  1.5239, grad_norm :0.0008, param_norm: 1.2659, expected_regret: 0.3008 expected_RLHFobj: 0.5967, reward_accuracy: 0.6600
Iteration:  599, train_loss:  1.5188, valid_loss:  1.5672, grad_norm :0.0001, param_norm: 1.2775, expected_regret: 0.2460 expected_RLHFobj: 0.5515, reward_accuracy: 0.6700
Iteration:  699, train_loss:  1.5339, valid_loss:  1.5836, grad_norm :0.0004, param_norm: 1.2820, expected_regret: 0.1951 expected_RLHFobj: 0.4888, reward_accuracy: 0.6600
Iteration:  799, train_loss:  1.5367, valid_loss:  1.5880, grad_norm :0.0006, param_norm: 1.2833, expected_regret: 0.1587 expected_RLHFobj: 0.4258, reward_accuracy: 0.6600
Iteration:  899, train_loss:  1.5726, valid_loss:  1.6248, grad_norm :0.0040, param_norm: 1.2937, expected_regret: 0.1016 expected_RLHFobj: 0.3801, reward_accuracy: 0.6700
Iteration:  999, train_loss:  1.5835, valid_loss:  1.6372, grad_norm :0.0026, param_norm: 1.2994, expected_regret: 0.0560 expected_RLHFobj: 0.3251, reward_accuracy: 0.6600
Logging to logs/exp2_tv/nsdpo_g0.3/2024-11-26-12-56-25/dpo_2024
Seed:2024
reset state dist uniform
Dataset loaded: ./datasets/exp1.pkl
opt_params: (100, 8) | train_data: (2000, 7) | valid_data: (10000, 7)
Iteration:  0, train_loss:  1.4827, valid_loss:  1.4500, grad_norm :0.0181, param_norm: 1.3718, expected_regret: 3.4206 expected_RLHFobj: 3.6816, reward_accuracy: 0.3400
Iteration:  99, train_loss:  0.8701, valid_loss:  0.8847, grad_norm :0.0957, param_norm: 1.0646, expected_regret: 1.7467 expected_RLHFobj: 1.5936, reward_accuracy: 0.5600
Iteration:  199, train_loss:  0.9298, valid_loss:  0.9495, grad_norm :0.0320, param_norm: 1.0612, expected_regret: 0.9480 expected_RLHFobj: 0.7941, reward_accuracy: 0.6800
Iteration:  299, train_loss:  1.0355, valid_loss:  1.0566, grad_norm :0.0002, param_norm: 1.0799, expected_regret: 0.6836 expected_RLHFobj: 0.6097, reward_accuracy: 0.6900
Iteration:  399, train_loss:  1.0591, valid_loss:  1.0866, grad_norm :0.0252, param_norm: 1.0816, expected_regret: 0.5260 expected_RLHFobj: 0.4351, reward_accuracy: 0.6800
Iteration:  499, train_loss:  1.1154, valid_loss:  1.1444, grad_norm :0.0026, param_norm: 1.0935, expected_regret: 0.4399 expected_RLHFobj: 0.3835, reward_accuracy: 0.6600
Iteration:  599, train_loss:  1.1762, valid_loss:  1.2068, grad_norm :0.0007, param_norm: 1.1079, expected_regret: 0.3590 expected_RLHFobj: 0.3332, reward_accuracy: 0.6700
Iteration:  699, train_loss:  1.2480, valid_loss:  1.2795, grad_norm :0.0164, param_norm: 1.1250, expected_regret: 0.2958 expected_RLHFobj: 0.3221, reward_accuracy: 0.6800
Iteration:  799, train_loss:  1.2726, valid_loss:  1.3069, grad_norm :0.0055, param_norm: 1.1321, expected_regret: 0.2310 expected_RLHFobj: 0.2454, reward_accuracy: 0.6700
Iteration:  899, train_loss:  1.3294, valid_loss:  1.3655, grad_norm :0.0004, param_norm: 1.1484, expected_regret: 0.1752 expected_RLHFobj: 0.2240, reward_accuracy: 0.6800
Iteration:  999, train_loss:  1.3723, valid_loss:  1.4102, grad_norm :0.0001, param_norm: 1.1610, expected_regret: 0.1310 expected_RLHFobj: 0.2046, reward_accuracy: 0.6900
Logging to logs/exp2_tv/nsdpo_g0.3/2024-11-26-12-56-25/dpo_2025
Seed:2025
reset state dist uniform
Dataset loaded: ./datasets/exp1.pkl
opt_params: (100, 8) | train_data: (2000, 7) | valid_data: (10000, 7)
Iteration:  0, train_loss:  1.4613, valid_loss:  1.4114, grad_norm :0.0222, param_norm: 1.8237, expected_regret: 4.0232 expected_RLHFobj: 4.4300, reward_accuracy: 0.3300
Iteration:  99, train_loss:  1.0469, valid_loss:  1.0593, grad_norm :0.0187, param_norm: 1.6340, expected_regret: 1.8759 expected_RLHFobj: 2.1034, reward_accuracy: 0.5600
Iteration:  199, train_loss:  0.9793, valid_loss:  1.0134, grad_norm :0.0021, param_norm: 1.6011, expected_regret: 1.2534 expected_RLHFobj: 1.4041, reward_accuracy: 0.6000
Iteration:  299, train_loss:  1.0130, valid_loss:  1.0503, grad_norm :0.0130, param_norm: 1.5967, expected_regret: 0.8931 expected_RLHFobj: 1.0254, reward_accuracy: 0.6300
Iteration:  399, train_loss:  1.0532, valid_loss:  1.0939, grad_norm :0.0090, param_norm: 1.5988, expected_regret: 0.7012 expected_RLHFobj: 0.8311, reward_accuracy: 0.6200
Iteration:  499, train_loss:  1.1238, valid_loss:  1.1666, grad_norm :0.0003, param_norm: 1.6069, expected_regret: 0.5447 expected_RLHFobj: 0.6995, reward_accuracy: 0.6400
Iteration:  599, train_loss:  1.1917, valid_loss:  1.2346, grad_norm :0.0372, param_norm: 1.6155, expected_regret: 0.4474 expected_RLHFobj: 0.6408, reward_accuracy: 0.6600
Iteration:  699, train_loss:  1.2446, valid_loss:  1.2893, grad_norm :0.0992, param_norm: 1.6238, expected_regret: 0.3867 expected_RLHFobj: 0.6069, reward_accuracy: 0.6600
Iteration:  799, train_loss:  1.2812, valid_loss:  1.3282, grad_norm :0.0001, param_norm: 1.6295, expected_regret: 0.3286 expected_RLHFobj: 0.5500, reward_accuracy: 0.6600
Iteration:  899, train_loss:  1.3247, valid_loss:  1.3719, grad_norm :0.0265, param_norm: 1.6373, expected_regret: 0.2836 expected_RLHFobj: 0.5313, reward_accuracy: 0.6500
Iteration:  999, train_loss:  1.3680, valid_loss:  1.4157, grad_norm :0.0058, param_norm: 1.6445, expected_regret: 0.2477 expected_RLHFobj: 0.5110, reward_accuracy: 0.6500
Logging to logs/exp2_tv/nsdpo_g0.9/2024-11-26-12-56-52/dpo_2021
Seed:2021
reset state dist uniform
Dataset loaded: ./datasets/exp1.pkl
opt_params: (100, 8) | train_data: (2000, 7) | valid_data: (10000, 7)
Iteration:  0, train_loss:  1.9397, valid_loss:  1.8114, grad_norm :0.1607, param_norm: 1.6016, expected_regret: 3.5037 expected_RLHFobj: 4.0075, reward_accuracy: 0.3900
Iteration:  99, train_loss:  1.1054, valid_loss:  1.1093, grad_norm :0.0662, param_norm: 1.1239, expected_regret: 1.0837 expected_RLHFobj: 1.1062, reward_accuracy: 0.6400
Iteration:  199, train_loss:  1.1394, valid_loss:  1.1620, grad_norm :0.0345, param_norm: 1.1079, expected_regret: 0.4798 expected_RLHFobj: 0.4316, reward_accuracy: 0.6800
Iteration:  299, train_loss:  1.2052, valid_loss:  1.2338, grad_norm :0.0104, param_norm: 1.1172, expected_regret: 0.2684 expected_RLHFobj: 0.2026, reward_accuracy: 0.7000
Iteration:  399, train_loss:  1.3053, valid_loss:  1.3377, grad_norm :0.0407, param_norm: 1.1404, expected_regret: 0.1586 expected_RLHFobj: 0.1467, reward_accuracy: 0.7400
Iteration:  499, train_loss:  1.3751, valid_loss:  1.4105, grad_norm :0.0187, param_norm: 1.1574, expected_regret: 0.0990 expected_RLHFobj: 0.1275, reward_accuracy: 0.7300
Iteration:  599, train_loss:  1.4439, valid_loss:  1.4809, grad_norm :0.0434, param_norm: 1.1732, expected_regret: 0.0580 expected_RLHFobj: 0.1206, reward_accuracy: 0.7200
Iteration:  699, train_loss:  1.5206, valid_loss:  1.5600, grad_norm :0.0079, param_norm: 1.1949, expected_regret: 0.0116 expected_RLHFobj: 0.1239, reward_accuracy: 0.7300
Iteration:  799, train_loss:  1.5668, valid_loss:  1.6087, grad_norm :0.0391, param_norm: 1.2089, expected_regret: -0.0131 expected_RLHFobj: 0.1193, reward_accuracy: 0.7400
Iteration:  899, train_loss:  1.6128, valid_loss:  1.6551, grad_norm :0.0513, param_norm: 1.2202, expected_regret: -0.0290 expected_RLHFobj: 0.1223, reward_accuracy: 0.7400
Iteration:  999, train_loss:  1.6235, valid_loss:  1.6664, grad_norm :0.0275, param_norm: 1.2220, expected_regret: -0.0318 expected_RLHFobj: 0.1232, reward_accuracy: 0.7300
Logging to logs/exp2_tv/nsdpo_g0.9/2024-11-26-12-56-52/dpo_2022
Seed:2022
reset state dist uniform
Dataset loaded: ./datasets/exp1.pkl
opt_params: (100, 8) | train_data: (2000, 7) | valid_data: (10000, 7)
Iteration:  0, train_loss:  1.9112, valid_loss:  1.8197, grad_norm :0.3010, param_norm: 2.1226, expected_regret: 4.1627 expected_RLHFobj: 4.8031, reward_accuracy: 0.3800
Iteration:  99, train_loss:  0.8690, valid_loss:  0.8900, grad_norm :0.2494, param_norm: 1.6835, expected_regret: 2.1937 expected_RLHFobj: 2.2903, reward_accuracy: 0.5200
Iteration:  199, train_loss:  0.9282, valid_loss:  0.9636, grad_norm :0.1596, param_norm: 1.6596, expected_regret: 0.8730 expected_RLHFobj: 0.8687, reward_accuracy: 0.6300
Iteration:  299, train_loss:  1.0698, valid_loss:  1.1059, grad_norm :0.0284, param_norm: 1.6638, expected_regret: 0.4761 expected_RLHFobj: 0.5340, reward_accuracy: 0.6600
Iteration:  399, train_loss:  1.1829, valid_loss:  1.2230, grad_norm :0.0425, param_norm: 1.6729, expected_regret: 0.2946 expected_RLHFobj: 0.4102, reward_accuracy: 0.7000
Iteration:  499, train_loss:  1.2611, valid_loss:  1.3039, grad_norm :0.0821, param_norm: 1.6803, expected_regret: 0.2068 expected_RLHFobj: 0.3647, reward_accuracy: 0.7100
Iteration:  599, train_loss:  1.3444, valid_loss:  1.3893, grad_norm :0.0160, param_norm: 1.6885, expected_regret: 0.1356 expected_RLHFobj: 0.3385, reward_accuracy: 0.7400
Iteration:  699, train_loss:  1.4105, valid_loss:  1.4567, grad_norm :0.0401, param_norm: 1.6946, expected_regret: 0.0896 expected_RLHFobj: 0.3246, reward_accuracy: 0.7500
Iteration:  799, train_loss:  1.4621, valid_loss:  1.5099, grad_norm :0.0752, param_norm: 1.7007, expected_regret: 0.0581 expected_RLHFobj: 0.3175, reward_accuracy: 0.7500
Iteration:  899, train_loss:  1.5156, valid_loss:  1.5642, grad_norm :0.0550, param_norm: 1.7064, expected_regret: 0.0260 expected_RLHFobj: 0.3128, reward_accuracy: 0.7500
Iteration:  999, train_loss:  1.5622, valid_loss:  1.6122, grad_norm :0.0179, param_norm: 1.7130, expected_regret: 0.0059 expected_RLHFobj: 0.3159, reward_accuracy: 0.7500
Logging to logs/exp2_tv/nsdpo_g0.9/2024-11-26-12-56-52/dpo_2023
Seed:2023
reset state dist uniform
Dataset loaded: ./datasets/exp1.pkl
opt_params: (100, 8) | train_data: (2000, 7) | valid_data: (10000, 7)
Iteration:  0, train_loss:  1.3383, valid_loss:  1.3629, grad_norm :0.2005, param_norm: 1.3163, expected_regret: 1.8917 expected_RLHFobj: 2.3305, reward_accuracy: 0.5400
Iteration:  99, train_loss:  1.1963, valid_loss:  1.2405, grad_norm :0.0500, param_norm: 1.1440, expected_regret: 0.3715 expected_RLHFobj: 0.4394, reward_accuracy: 0.6500
Iteration:  199, train_loss:  1.3538, valid_loss:  1.3963, grad_norm :0.0188, param_norm: 1.1615, expected_regret: 0.1290 expected_RLHFobj: 0.2292, reward_accuracy: 0.7000
Iteration:  299, train_loss:  1.4499, valid_loss:  1.4932, grad_norm :0.0262, param_norm: 1.1789, expected_regret: 0.0429 expected_RLHFobj: 0.1632, reward_accuracy: 0.7400
Iteration:  399, train_loss:  1.5504, valid_loss:  1.5962, grad_norm :0.0350, param_norm: 1.2065, expected_regret: -0.0071 expected_RLHFobj: 0.1618, reward_accuracy: 0.7300
Iteration:  499, train_loss:  1.6179, valid_loss:  1.6645, grad_norm :0.0224, param_norm: 1.2236, expected_regret: -0.0306 expected_RLHFobj: 0.1694, reward_accuracy: 0.7400
Iteration:  599, train_loss:  1.6615, valid_loss:  1.7093, grad_norm :0.0191, param_norm: 1.2340, expected_regret: -0.0506 expected_RLHFobj: 0.1676, reward_accuracy: 0.7400
Iteration:  699, train_loss:  1.6909, valid_loss:  1.7413, grad_norm :0.0546, param_norm: 1.2437, expected_regret: -0.0688 expected_RLHFobj: 0.1687, reward_accuracy: 0.7400
Iteration:  799, train_loss:  1.7134, valid_loss:  1.7639, grad_norm :0.0254, param_norm: 1.2484, expected_regret: -0.0714 expected_RLHFobj: 0.1741, reward_accuracy: 0.7300
Iteration:  899, train_loss:  1.7359, valid_loss:  1.7883, grad_norm :0.0237, param_norm: 1.2555, expected_regret: -0.0848 expected_RLHFobj: 0.1734, reward_accuracy: 0.7300
Iteration:  999, train_loss:  1.7529, valid_loss:  1.8051, grad_norm :0.0283, param_norm: 1.2592, expected_regret: -0.0843 expected_RLHFobj: 0.1768, reward_accuracy: 0.7300
Logging to logs/exp2_tv/nsdpo_g0.9/2024-11-26-12-56-52/dpo_2024
Seed:2024
reset state dist uniform
Dataset loaded: ./datasets/exp1.pkl
opt_params: (100, 8) | train_data: (2000, 7) | valid_data: (10000, 7)
Iteration:  0, train_loss:  1.4966, valid_loss:  1.4662, grad_norm :0.2817, param_norm: 1.3753, expected_regret: 3.4349 expected_RLHFobj: 3.7001, reward_accuracy: 0.3600
Iteration:  99, train_loss:  0.8783, valid_loss:  0.9076, grad_norm :0.0790, param_norm: 1.0313, expected_regret: 0.7592 expected_RLHFobj: 0.4507, reward_accuracy: 0.6300
Iteration:  199, train_loss:  1.0789, valid_loss:  1.1072, grad_norm :0.0091, param_norm: 1.0604, expected_regret: 0.3590 expected_RLHFobj: 0.1794, reward_accuracy: 0.7100
Iteration:  299, train_loss:  1.1996, valid_loss:  1.2299, grad_norm :0.0251, param_norm: 1.0873, expected_regret: 0.2420 expected_RLHFobj: 0.1474, reward_accuracy: 0.7400
Iteration:  399, train_loss:  1.2776, valid_loss:  1.3111, grad_norm :0.0370, param_norm: 1.1069, expected_regret: 0.1735 expected_RLHFobj: 0.1351, reward_accuracy: 0.7400
Iteration:  499, train_loss:  1.3556, valid_loss:  1.3921, grad_norm :0.0387, param_norm: 1.1273, expected_regret: 0.1091 expected_RLHFobj: 0.1249, reward_accuracy: 0.7400
Iteration:  599, train_loss:  1.4256, valid_loss:  1.4629, grad_norm :0.0050, param_norm: 1.1448, expected_regret: 0.0734 expected_RLHFobj: 0.1258, reward_accuracy: 0.7300
Iteration:  699, train_loss:  1.4852, valid_loss:  1.5253, grad_norm :0.0141, param_norm: 1.1611, expected_regret: 0.0357 expected_RLHFobj: 0.1172, reward_accuracy: 0.7400
Iteration:  799, train_loss:  1.5350, valid_loss:  1.5772, grad_norm :0.0409, param_norm: 1.1750, expected_regret: 0.0125 expected_RLHFobj: 0.1194, reward_accuracy: 0.7300
Iteration:  899, train_loss:  1.5893, valid_loss:  1.6336, grad_norm :0.0115, param_norm: 1.1929, expected_regret: -0.0195 expected_RLHFobj: 0.1236, reward_accuracy: 0.7400
Iteration:  999, train_loss:  1.6292, valid_loss:  1.6744, grad_norm :0.0110, param_norm: 1.2046, expected_regret: -0.0381 expected_RLHFobj: 0.1278, reward_accuracy: 0.7400
Logging to logs/exp2_tv/nsdpo_g0.9/2024-11-26-12-56-52/dpo_2025
Seed:2025
reset state dist uniform
Dataset loaded: ./datasets/exp1.pkl
opt_params: (100, 8) | train_data: (2000, 7) | valid_data: (10000, 7)
Iteration:  0, train_loss:  1.3658, valid_loss:  1.3208, grad_norm :0.1670, param_norm: 1.7810, expected_regret: 3.9157 expected_RLHFobj: 4.2666, reward_accuracy: 0.3300
Iteration:  99, train_loss:  0.8990, valid_loss:  0.9321, grad_norm :0.0253, param_norm: 1.5627, expected_regret: 0.8153 expected_RLHFobj: 0.7220, reward_accuracy: 0.6600
Iteration:  199, train_loss:  1.1098, valid_loss:  1.1454, grad_norm :0.0157, param_norm: 1.5750, expected_regret: 0.3732 expected_RLHFobj: 0.4064, reward_accuracy: 0.6900
Iteration:  299, train_loss:  1.2289, valid_loss:  1.2687, grad_norm :0.0344, param_norm: 1.5880, expected_regret: 0.2225 expected_RLHFobj: 0.3206, reward_accuracy: 0.7200
Iteration:  399, train_loss:  1.3361, valid_loss:  1.3793, grad_norm :0.0400, param_norm: 1.6025, expected_regret: 0.1300 expected_RLHFobj: 0.2936, reward_accuracy: 0.7400
Iteration:  499, train_loss:  1.4066, valid_loss:  1.4517, grad_norm :0.0274, param_norm: 1.6115, expected_regret: 0.0831 expected_RLHFobj: 0.2829, reward_accuracy: 0.7400
Iteration:  599, train_loss:  1.4786, valid_loss:  1.5253, grad_norm :0.0257, param_norm: 1.6218, expected_regret: 0.0404 expected_RLHFobj: 0.2812, reward_accuracy: 0.7400
Iteration:  699, train_loss:  1.5553, valid_loss:  1.6041, grad_norm :0.0547, param_norm: 1.6345, expected_regret: 0.0048 expected_RLHFobj: 0.2836, reward_accuracy: 0.7500
Iteration:  799, train_loss:  1.5951, valid_loss:  1.6467, grad_norm :0.0272, param_norm: 1.6416, expected_regret: -0.0153 expected_RLHFobj: 0.2841, reward_accuracy: 0.7300
Iteration:  899, train_loss:  1.6368, valid_loss:  1.6908, grad_norm :0.0238, param_norm: 1.6484, expected_regret: -0.0450 expected_RLHFobj: 0.2822, reward_accuracy: 0.7400
Iteration:  999, train_loss:  1.6712, valid_loss:  1.7244, grad_norm :0.0492, param_norm: 1.6518, expected_regret: -0.0490 expected_RLHFobj: 0.2877, reward_accuracy: 0.7500
Logging to logs/exp2_tv/dpo_g1.0/2024-11-26-12-57-19/dpo_2021
Seed:2021
reset state dist uniform
Dataset loaded: ./datasets/exp1.pkl
opt_params: (100, 8) | train_data: (2000, 7) | valid_data: (10000, 7)
Iteration:  0, train_loss:  1.8560, valid_loss:  1.7345, grad_norm :1.3165, param_norm: 1.5612, expected_regret: 3.5486 expected_RLHFobj: 3.9989, reward_accuracy: 0.3800
Iteration:  99, train_loss:  0.6870, valid_loss:  0.6887, grad_norm :0.4412, param_norm: 1.0201, expected_regret: 2.5190 expected_RLHFobj: 1.9032, reward_accuracy: 0.4200
Iteration:  199, train_loss:  0.6869, valid_loss:  0.6893, grad_norm :0.5631, param_norm: 1.0006, expected_regret: 2.4627 expected_RLHFobj: 1.8353, reward_accuracy: 0.4100
Iteration:  299, train_loss:  0.6863, valid_loss:  0.6881, grad_norm :0.4157, param_norm: 0.9886, expected_regret: 2.4877 expected_RLHFobj: 1.8774, reward_accuracy: 0.4400
Iteration:  399, train_loss:  0.6857, valid_loss:  0.6882, grad_norm :0.5411, param_norm: 0.9748, expected_regret: 2.4303 expected_RLHFobj: 1.8064, reward_accuracy: 0.4500
Iteration:  499, train_loss:  0.6854, valid_loss:  0.6879, grad_norm :0.4689, param_norm: 0.9600, expected_regret: 2.3988 expected_RLHFobj: 1.7704, reward_accuracy: 0.4600
Iteration:  599, train_loss:  0.6853, valid_loss:  0.6886, grad_norm :0.2218, param_norm: 0.9458, expected_regret: 2.3588 expected_RLHFobj: 1.7258, reward_accuracy: 0.4600
Iteration:  699, train_loss:  0.6849, valid_loss:  0.6863, grad_norm :0.5223, param_norm: 0.9377, expected_regret: 2.4759 expected_RLHFobj: 1.8442, reward_accuracy: 0.4100
Iteration:  799, train_loss:  0.6847, valid_loss:  0.6860, grad_norm :0.3631, param_norm: 0.9286, expected_regret: 2.4706 expected_RLHFobj: 1.8341, reward_accuracy: 0.4100
Iteration:  899, train_loss:  0.6843, valid_loss:  0.6862, grad_norm :0.7945, param_norm: 0.9192, expected_regret: 2.4383 expected_RLHFobj: 1.8039, reward_accuracy: 0.4400
Iteration:  999, train_loss:  0.6845, valid_loss:  0.6858, grad_norm :0.7593, param_norm: 0.9099, expected_regret: 2.3892 expected_RLHFobj: 1.7603, reward_accuracy: 0.4800
Logging to logs/exp2_tv/dpo_g1.0/2024-11-26-12-57-19/dpo_2022
Seed:2022
reset state dist uniform
Dataset loaded: ./datasets/exp1.pkl
opt_params: (100, 8) | train_data: (2000, 7) | valid_data: (10000, 7)
Iteration:  0, train_loss:  1.8684, valid_loss:  1.7803, grad_norm :1.2088, param_norm: 2.0932, expected_regret: 4.2584 expected_RLHFobj: 4.8787, reward_accuracy: 0.3500
Iteration:  99, train_loss:  0.7170, valid_loss:  0.7316, grad_norm :0.5284, param_norm: 1.6146, expected_regret: 2.5755 expected_RLHFobj: 2.2479, reward_accuracy: 0.4600
Iteration:  199, train_loss:  0.7117, valid_loss:  0.7277, grad_norm :0.7250, param_norm: 1.5678, expected_regret: 2.5105 expected_RLHFobj: 2.1256, reward_accuracy: 0.4600
Iteration:  299, train_loss:  0.7110, valid_loss:  0.7254, grad_norm :0.3420, param_norm: 1.5279, expected_regret: 2.5569 expected_RLHFobj: 2.1511, reward_accuracy: 0.4100
Iteration:  399, train_loss:  0.7082, valid_loss:  0.7209, grad_norm :0.5322, param_norm: 1.4907, expected_regret: 2.5926 expected_RLHFobj: 2.1835, reward_accuracy: 0.4600
Iteration:  499, train_loss:  0.7068, valid_loss:  0.7200, grad_norm :0.1876, param_norm: 1.4570, expected_regret: 2.5748 expected_RLHFobj: 2.1456, reward_accuracy: 0.4300
Iteration:  599, train_loss:  0.7049, valid_loss:  0.7181, grad_norm :0.4682, param_norm: 1.4275, expected_regret: 2.4855 expected_RLHFobj: 2.0403, reward_accuracy: 0.4800
Iteration:  699, train_loss:  0.7039, valid_loss:  0.7168, grad_norm :0.2219, param_norm: 1.4008, expected_regret: 2.4777 expected_RLHFobj: 2.0219, reward_accuracy: 0.4800
Iteration:  799, train_loss:  0.7027, valid_loss:  0.7145, grad_norm :0.5209, param_norm: 1.3754, expected_regret: 2.5417 expected_RLHFobj: 2.0731, reward_accuracy: 0.4400
Iteration:  899, train_loss:  0.7017, valid_loss:  0.7136, grad_norm :0.4145, param_norm: 1.3523, expected_regret: 2.5068 expected_RLHFobj: 2.0289, reward_accuracy: 0.4700
Iteration:  999, train_loss:  0.7009, valid_loss:  0.7121, grad_norm :0.5783, param_norm: 1.3291, expected_regret: 2.5148 expected_RLHFobj: 2.0299, reward_accuracy: 0.4700
Logging to logs/exp2_tv/dpo_g1.0/2024-11-26-12-57-19/dpo_2023
Seed:2023
reset state dist uniform
Dataset loaded: ./datasets/exp1.pkl
opt_params: (100, 8) | train_data: (2000, 7) | valid_data: (10000, 7)
Iteration:  0, train_loss:  1.2705, valid_loss:  1.2879, grad_norm :1.5815, param_norm: 1.2923, expected_regret: 2.0813 expected_RLHFobj: 2.4614, reward_accuracy: 0.5200
Iteration:  99, train_loss:  0.6903, valid_loss:  0.6984, grad_norm :0.4042, param_norm: 0.9935, expected_regret: 2.4263 expected_RLHFobj: 1.8550, reward_accuracy: 0.4800
Iteration:  199, train_loss:  0.6894, valid_loss:  0.6965, grad_norm :0.7997, param_norm: 0.9563, expected_regret: 2.4828 expected_RLHFobj: 1.8875, reward_accuracy: 0.4200
Iteration:  299, train_loss:  0.6878, valid_loss:  0.6942, grad_norm :0.4922, param_norm: 0.9275, expected_regret: 2.4559 expected_RLHFobj: 1.8608, reward_accuracy: 0.4500
Iteration:  399, train_loss:  0.6875, valid_loss:  0.6942, grad_norm :0.4705, param_norm: 0.9041, expected_regret: 2.4101 expected_RLHFobj: 1.8159, reward_accuracy: 0.4600
Iteration:  499, train_loss:  0.6873, valid_loss:  0.6945, grad_norm :0.5963, param_norm: 0.8851, expected_regret: 2.3666 expected_RLHFobj: 1.7623, reward_accuracy: 0.4800
Iteration:  599, train_loss:  0.6869, valid_loss:  0.6934, grad_norm :0.4235, param_norm: 0.8637, expected_regret: 2.4419 expected_RLHFobj: 1.8304, reward_accuracy: 0.4400
Iteration:  699, train_loss:  0.6859, valid_loss:  0.6918, grad_norm :0.5789, param_norm: 0.8467, expected_regret: 2.4353 expected_RLHFobj: 1.8286, reward_accuracy: 0.4500
Iteration:  799, train_loss:  0.6855, valid_loss:  0.6915, grad_norm :0.5092, param_norm: 0.8285, expected_regret: 2.4143 expected_RLHFobj: 1.7979, reward_accuracy: 0.4600
Iteration:  899, train_loss:  0.6852, valid_loss:  0.6907, grad_norm :0.7198, param_norm: 0.8144, expected_regret: 2.4117 expected_RLHFobj: 1.8018, reward_accuracy: 0.4500
Iteration:  999, train_loss:  0.6848, valid_loss:  0.6903, grad_norm :0.4497, param_norm: 0.7977, expected_regret: 2.4248 expected_RLHFobj: 1.8013, reward_accuracy: 0.4400
Logging to logs/exp2_tv/dpo_g1.0/2024-11-26-12-57-19/dpo_2024
Seed:2024
reset state dist uniform
Dataset loaded: ./datasets/exp1.pkl
opt_params: (100, 8) | train_data: (2000, 7) | valid_data: (10000, 7)
Iteration:  0, train_loss:  1.4652, valid_loss:  1.4267, grad_norm :1.4550, param_norm: 1.3613, expected_regret: 3.6148 expected_RLHFobj: 3.8601, reward_accuracy: 0.3500
Iteration:  99, train_loss:  0.6858, valid_loss:  0.6920, grad_norm :0.4150, param_norm: 0.9867, expected_regret: 2.4436 expected_RLHFobj: 1.8208, reward_accuracy: 0.4300
Iteration:  199, train_loss:  0.6852, valid_loss:  0.6914, grad_norm :0.4084, param_norm: 0.9708, expected_regret: 2.4345 expected_RLHFobj: 1.8184, reward_accuracy: 0.4400
Iteration:  299, train_loss:  0.6843, valid_loss:  0.6894, grad_norm :0.1623, param_norm: 0.9540, expected_regret: 2.4783 expected_RLHFobj: 1.8580, reward_accuracy: 0.4200
Iteration:  399, train_loss:  0.6843, valid_loss:  0.6894, grad_norm :0.2295, param_norm: 0.9381, expected_regret: 2.4220 expected_RLHFobj: 1.7930, reward_accuracy: 0.4600
Iteration:  499, train_loss:  0.6841, valid_loss:  0.6903, grad_norm :0.6853, param_norm: 0.9267, expected_regret: 2.3936 expected_RLHFobj: 1.7626, reward_accuracy: 0.4400
Iteration:  599, train_loss:  0.6836, valid_loss:  0.6880, grad_norm :0.3617, param_norm: 0.9167, expected_regret: 2.5013 expected_RLHFobj: 1.8787, reward_accuracy: 0.4200
Iteration:  699, train_loss:  0.6835, valid_loss:  0.6886, grad_norm :0.6021, param_norm: 0.9076, expected_regret: 2.4650 expected_RLHFobj: 1.8436, reward_accuracy: 0.4400
Iteration:  799, train_loss:  0.6831, valid_loss:  0.6883, grad_norm :0.3256, param_norm: 0.8979, expected_regret: 2.4586 expected_RLHFobj: 1.8254, reward_accuracy: 0.4200
Iteration:  899, train_loss:  0.6829, valid_loss:  0.6872, grad_norm :0.3144, param_norm: 0.8897, expected_regret: 2.4841 expected_RLHFobj: 1.8472, reward_accuracy: 0.3900
Iteration:  999, train_loss:  0.6827, valid_loss:  0.6875, grad_norm :0.5683, param_norm: 0.8825, expected_regret: 2.4310 expected_RLHFobj: 1.8029, reward_accuracy: 0.4400
Logging to logs/exp2_tv/dpo_g1.0/2024-11-26-12-57-19/dpo_2025
Seed:2025
reset state dist uniform
Dataset loaded: ./datasets/exp1.pkl
opt_params: (100, 8) | train_data: (2000, 7) | valid_data: (10000, 7)
Iteration:  0, train_loss:  1.3508, valid_loss:  1.3051, grad_norm :1.3704, param_norm: 1.7728, expected_regret: 3.9353 expected_RLHFobj: 4.2778, reward_accuracy: 0.3400
Iteration:  99, train_loss:  0.7073, valid_loss:  0.7205, grad_norm :0.3192, param_norm: 1.4943, expected_regret: 2.5004 expected_RLHFobj: 2.0817, reward_accuracy: 0.4700
Iteration:  199, train_loss:  0.7045, valid_loss:  0.7162, grad_norm :0.4867, param_norm: 1.4417, expected_regret: 2.5956 expected_RLHFobj: 2.1487, reward_accuracy: 0.4400
Iteration:  299, train_loss:  0.7031, valid_loss:  0.7152, grad_norm :0.2992, param_norm: 1.3972, expected_regret: 2.4866 expected_RLHFobj: 2.0139, reward_accuracy: 0.4500
Iteration:  399, train_loss:  0.7009, valid_loss:  0.7116, grad_norm :0.3273, param_norm: 1.3604, expected_regret: 2.5102 expected_RLHFobj: 2.0335, reward_accuracy: 0.5000
Iteration:  499, train_loss:  0.6995, valid_loss:  0.7104, grad_norm :0.4413, param_norm: 1.3279, expected_regret: 2.5090 expected_RLHFobj: 2.0046, reward_accuracy: 0.4600
Iteration:  599, train_loss:  0.6987, valid_loss:  0.7090, grad_norm :0.6634, param_norm: 1.2999, expected_regret: 2.5206 expected_RLHFobj: 2.0162, reward_accuracy: 0.4400
Iteration:  699, train_loss:  0.6974, valid_loss:  0.7081, grad_norm :0.3924, param_norm: 1.2720, expected_regret: 2.4126 expected_RLHFobj: 1.8985, reward_accuracy: 0.4900
Iteration:  799, train_loss:  0.6968, valid_loss:  0.7065, grad_norm :0.4027, param_norm: 1.2492, expected_regret: 2.4251 expected_RLHFobj: 1.8966, reward_accuracy: 0.5000
Iteration:  899, train_loss:  0.6955, valid_loss:  0.7050, grad_norm :0.4104, param_norm: 1.2267, expected_regret: 2.4694 expected_RLHFobj: 1.9400, reward_accuracy: 0.4500
Iteration:  999, train_loss:  0.6950, valid_loss:  0.7047, grad_norm :0.2431, param_norm: 1.2047, expected_regret: 2.4139 expected_RLHFobj: 1.8855, reward_accuracy: 0.4800
Logging to logs/exp2_tv/nsdpo_g0.7/2024-11-26-12-57-27/dpo_2021
Seed:2021
reset state dist uniform
Dataset loaded: ./datasets/exp1.pkl
opt_params: (100, 8) | train_data: (2000, 7) | valid_data: (10000, 7)
Iteration:  0, train_loss:  1.9991, valid_loss:  1.8657, grad_norm :0.0919, param_norm: 1.6325, expected_regret: 3.4920 expected_RLHFobj: 4.0217, reward_accuracy: 0.3900
Iteration:  99, train_loss:  1.3461, valid_loss:  1.3193, grad_norm :0.0445, param_norm: 1.2372, expected_regret: 1.8722 expected_RLHFobj: 2.1006, reward_accuracy: 0.5600
Iteration:  199, train_loss:  1.3437, valid_loss:  1.3410, grad_norm :0.0190, param_norm: 1.2067, expected_regret: 1.1142 expected_RLHFobj: 1.3473, reward_accuracy: 0.6500
Iteration:  299, train_loss:  1.2613, valid_loss:  1.2733, grad_norm :0.0015, param_norm: 1.1600, expected_regret: 0.8025 expected_RLHFobj: 0.9490, reward_accuracy: 0.6600
Iteration:  399, train_loss:  1.2758, valid_loss:  1.2949, grad_norm :0.1114, param_norm: 1.1552, expected_regret: 0.6231 expected_RLHFobj: 0.7475, reward_accuracy: 0.6600
Iteration:  499, train_loss:  1.2742, valid_loss:  1.2990, grad_norm :0.0090, param_norm: 1.1487, expected_regret: 0.4909 expected_RLHFobj: 0.5784, reward_accuracy: 0.6500
Iteration:  599, train_loss:  1.2966, valid_loss:  1.3249, grad_norm :0.0074, param_norm: 1.1514, expected_regret: 0.3966 expected_RLHFobj: 0.4649, reward_accuracy: 0.6500
Iteration:  699, train_loss:  1.3714, valid_loss:  1.4023, grad_norm :0.0044, param_norm: 1.1691, expected_regret: 0.2847 expected_RLHFobj: 0.3951, reward_accuracy: 0.6800
Iteration:  799, train_loss:  1.3957, valid_loss:  1.4299, grad_norm :0.0073, param_norm: 1.1760, expected_regret: 0.2162 expected_RLHFobj: 0.3227, reward_accuracy: 0.6700
Iteration:  899, train_loss:  1.4264, valid_loss:  1.4620, grad_norm :0.0059, param_norm: 1.1840, expected_regret: 0.1698 expected_RLHFobj: 0.2837, reward_accuracy: 0.6700
Iteration:  999, train_loss:  1.4423, valid_loss:  1.4794, grad_norm :0.0130, param_norm: 1.1879, expected_regret: 0.1398 expected_RLHFobj: 0.2514, reward_accuracy: 0.6900
Logging to logs/exp2_tv/nsdpo_g0.7/2024-11-26-12-57-27/dpo_2022
Seed:2022
reset state dist uniform
Dataset loaded: ./datasets/exp1.pkl
opt_params: (100, 8) | train_data: (2000, 7) | valid_data: (10000, 7)
Iteration:  0, train_loss:  1.9224, valid_loss:  1.8302, grad_norm :0.2080, param_norm: 2.1279, expected_regret: 4.1893 expected_RLHFobj: 4.8347, reward_accuracy: 0.3500
Iteration:  99, train_loss:  1.1849, valid_loss:  1.1580, grad_norm :0.1213, param_norm: 1.7887, expected_regret: 3.0239 expected_RLHFobj: 3.3879, reward_accuracy: 0.4400
Iteration:  199, train_loss:  0.9781, valid_loss:  0.9986, grad_norm :0.0933, param_norm: 1.7089, expected_regret: 2.0263 expected_RLHFobj: 2.2309, reward_accuracy: 0.5300
Iteration:  299, train_loss:  1.0297, valid_loss:  1.0588, grad_norm :0.0179, param_norm: 1.7012, expected_regret: 1.3273 expected_RLHFobj: 1.5370, reward_accuracy: 0.6100
Iteration:  399, train_loss:  1.1074, valid_loss:  1.1395, grad_norm :0.0225, param_norm: 1.7022, expected_regret: 0.9292 expected_RLHFobj: 1.1715, reward_accuracy: 0.6600
Iteration:  499, train_loss:  1.1297, valid_loss:  1.1669, grad_norm :0.0066, param_norm: 1.7000, expected_regret: 0.7549 expected_RLHFobj: 0.9827, reward_accuracy: 0.6400
Iteration:  599, train_loss:  1.1828, valid_loss:  1.2223, grad_norm :0.0053, param_norm: 1.7027, expected_regret: 0.6147 expected_RLHFobj: 0.8542, reward_accuracy: 0.6300
Iteration:  699, train_loss:  1.2187, valid_loss:  1.2608, grad_norm :0.0263, param_norm: 1.7046, expected_regret: 0.5167 expected_RLHFobj: 0.7603, reward_accuracy: 0.6300
Iteration:  799, train_loss:  1.2556, valid_loss:  1.2997, grad_norm :0.0319, param_norm: 1.7086, expected_regret: 0.4321 expected_RLHFobj: 0.6798, reward_accuracy: 0.6500
Iteration:  899, train_loss:  1.3026, valid_loss:  1.3475, grad_norm :0.0323, param_norm: 1.7133, expected_regret: 0.3569 expected_RLHFobj: 0.6231, reward_accuracy: 0.6600
Iteration:  999, train_loss:  1.3497, valid_loss:  1.3958, grad_norm :0.0119, param_norm: 1.7197, expected_regret: 0.2998 expected_RLHFobj: 0.5844, reward_accuracy: 0.6600
Logging to logs/exp2_tv/nsdpo_g0.7/2024-11-26-12-57-27/dpo_2023
Seed:2023
reset state dist uniform
Dataset loaded: ./datasets/exp1.pkl
opt_params: (100, 8) | train_data: (2000, 7) | valid_data: (10000, 7)
Iteration:  0, train_loss:  1.3638, valid_loss:  1.3851, grad_norm :0.0953, param_norm: 1.3280, expected_regret: 1.9182 expected_RLHFobj: 2.3694, reward_accuracy: 0.5300
Iteration:  99, train_loss:  1.2841, valid_loss:  1.3273, grad_norm :0.0067, param_norm: 1.2127, expected_regret: 0.6829 expected_RLHFobj: 0.9657, reward_accuracy: 0.6600
Iteration:  199, train_loss:  1.3873, valid_loss:  1.4299, grad_norm :0.0081, param_norm: 1.2178, expected_regret: 0.4383 expected_RLHFobj: 0.7191, reward_accuracy: 0.6800
Iteration:  299, train_loss:  1.4170, valid_loss:  1.4611, grad_norm :0.0037, param_norm: 1.2169, expected_regret: 0.3005 expected_RLHFobj: 0.5406, reward_accuracy: 0.6700
Iteration:  399, train_loss:  1.4538, valid_loss:  1.5007, grad_norm :0.0127, param_norm: 1.2258, expected_regret: 0.1890 expected_RLHFobj: 0.4021, reward_accuracy: 0.6600
Iteration:  499, train_loss:  1.4890, valid_loss:  1.5361, grad_norm :0.0078, param_norm: 1.2328, expected_regret: 0.1229 expected_RLHFobj: 0.3307, reward_accuracy: 0.6600
Iteration:  599, train_loss:  1.5336, valid_loss:  1.5806, grad_norm :0.0049, param_norm: 1.2443, expected_regret: 0.0816 expected_RLHFobj: 0.3035, reward_accuracy: 0.6700
Iteration:  699, train_loss:  1.5744, valid_loss:  1.6232, grad_norm :0.0128, param_norm: 1.2576, expected_regret: 0.0435 expected_RLHFobj: 0.2822, reward_accuracy: 0.6800
Iteration:  799, train_loss:  1.5894, valid_loss:  1.6390, grad_norm :0.0036, param_norm: 1.2620, expected_regret: 0.0274 expected_RLHFobj: 0.2607, reward_accuracy: 0.6800
Iteration:  899, train_loss:  1.6305, valid_loss:  1.6817, grad_norm :0.0064, param_norm: 1.2754, expected_regret: -0.0093 expected_RLHFobj: 0.2444, reward_accuracy: 0.7100
Iteration:  999, train_loss:  1.6470, valid_loss:  1.6990, grad_norm :0.0042, param_norm: 1.2823, expected_regret: -0.0281 expected_RLHFobj: 0.2256, reward_accuracy: 0.7100
Logging to logs/exp2_tv/nsdpo_g0.7/2024-11-26-12-57-27/dpo_2024
Seed:2024
reset state dist uniform
Dataset loaded: ./datasets/exp1.pkl
opt_params: (100, 8) | train_data: (2000, 7) | valid_data: (10000, 7)
Iteration:  0, train_loss:  1.4876, valid_loss:  1.4560, grad_norm :0.1066, param_norm: 1.3733, expected_regret: 3.4260 expected_RLHFobj: 3.6884, reward_accuracy: 0.3600
Iteration:  99, train_loss:  0.8228, valid_loss:  0.8456, grad_norm :0.0812, param_norm: 1.0406, expected_regret: 1.3565 expected_RLHFobj: 1.1007, reward_accuracy: 0.6100
Iteration:  199, train_loss:  0.9697, valid_loss:  0.9937, grad_norm :0.0220, param_norm: 1.0536, expected_regret: 0.6591 expected_RLHFobj: 0.4823, reward_accuracy: 0.6800
Iteration:  299, train_loss:  1.0760, valid_loss:  1.1012, grad_norm :0.0109, param_norm: 1.0748, expected_regret: 0.4958 expected_RLHFobj: 0.3924, reward_accuracy: 0.6700
Iteration:  399, train_loss:  1.1374, valid_loss:  1.1671, grad_norm :0.0262, param_norm: 1.0889, expected_regret: 0.3809 expected_RLHFobj: 0.3047, reward_accuracy: 0.6700
Iteration:  499, train_loss:  1.2065, valid_loss:  1.2379, grad_norm :0.0079, param_norm: 1.1053, expected_regret: 0.3015 expected_RLHFobj: 0.2731, reward_accuracy: 0.6700
Iteration:  599, train_loss:  1.2670, valid_loss:  1.2996, grad_norm :0.0013, param_norm: 1.1203, expected_regret: 0.2435 expected_RLHFobj: 0.2462, reward_accuracy: 0.6800
Iteration:  699, train_loss:  1.3293, valid_loss:  1.3636, grad_norm :0.0138, param_norm: 1.1361, expected_regret: 0.1878 expected_RLHFobj: 0.2311, reward_accuracy: 0.7000
Iteration:  799, train_loss:  1.3665, valid_loss:  1.4032, grad_norm :0.0137, param_norm: 1.1472, expected_regret: 0.1427 expected_RLHFobj: 0.1940, reward_accuracy: 0.7200
Iteration:  899, train_loss:  1.4269, valid_loss:  1.4657, grad_norm :0.0021, param_norm: 1.1658, expected_regret: 0.0945 expected_RLHFobj: 0.1847, reward_accuracy: 0.7200
Iteration:  999, train_loss:  1.4743, valid_loss:  1.5150, grad_norm :0.0015, param_norm: 1.1807, expected_regret: 0.0593 expected_RLHFobj: 0.1776, reward_accuracy: 0.7300
Logging to logs/exp2_tv/nsdpo_g0.7/2024-11-26-12-57-27/dpo_2025
Seed:2025
reset state dist uniform
Dataset loaded: ./datasets/exp1.pkl
opt_params: (100, 8) | train_data: (2000, 7) | valid_data: (10000, 7)
Iteration:  0, train_loss:  1.4109, valid_loss:  1.3640, grad_norm :0.0439, param_norm: 1.8010, expected_regret: 3.9372 expected_RLHFobj: 4.3133, reward_accuracy: 0.3300
Iteration:  99, train_loss:  0.9239, valid_loss:  0.9532, grad_norm :0.0471, param_norm: 1.5936, expected_regret: 1.5169 expected_RLHFobj: 1.6127, reward_accuracy: 0.6000
Iteration:  199, train_loss:  1.0169, valid_loss:  1.0518, grad_norm :0.0094, param_norm: 1.5859, expected_regret: 0.8227 expected_RLHFobj: 0.9299, reward_accuracy: 0.6500
Iteration:  299, train_loss:  1.0966, valid_loss:  1.1348, grad_norm :0.0286, param_norm: 1.5911, expected_regret: 0.5859 expected_RLHFobj: 0.7091, reward_accuracy: 0.6500
Iteration:  399, train_loss:  1.1685, valid_loss:  1.2100, grad_norm :0.0123, param_norm: 1.5996, expected_regret: 0.4312 expected_RLHFobj: 0.5722, reward_accuracy: 0.6400
Iteration:  499, train_loss:  1.2408, valid_loss:  1.2838, grad_norm :0.0113, param_norm: 1.6095, expected_regret: 0.3348 expected_RLHFobj: 0.5037, reward_accuracy: 0.6500
Iteration:  599, train_loss:  1.3104, valid_loss:  1.3539, grad_norm :0.0463, param_norm: 1.6192, expected_regret: 0.2629 expected_RLHFobj: 0.4699, reward_accuracy: 0.6600
Iteration:  699, train_loss:  1.3717, valid_loss:  1.4178, grad_norm :0.0898, param_norm: 1.6300, expected_regret: 0.2087 expected_RLHFobj: 0.4474, reward_accuracy: 0.6600
Iteration:  799, train_loss:  1.4100, valid_loss:  1.4585, grad_norm :0.0073, param_norm: 1.6376, expected_regret: 0.1705 expected_RLHFobj: 0.4233, reward_accuracy: 0.6400
Iteration:  899, train_loss:  1.4569, valid_loss:  1.5067, grad_norm :0.0268, param_norm: 1.6459, expected_regret: 0.1299 expected_RLHFobj: 0.4118, reward_accuracy: 0.6700
Iteration:  999, train_loss:  1.4967, valid_loss:  1.5466, grad_norm :0.0190, param_norm: 1.6524, expected_regret: 0.1098 expected_RLHFobj: 0.4064, reward_accuracy: 0.6700
Logging to logs/exp2_tv/sigmoid_g1.0/2024-11-26-12-57-54/sigmoidloss_2021
Seed:2021
reset state dist uniform
Dataset loaded: ./datasets/exp1.pkl
opt_params: (100, 8) | train_data: (2000, 7) | valid_data: (10000, 7)
Iteration:  0, train_loss:  7423825.1667, valid_loss:  173446739.6467, grad_norm :131.6579, param_norm: 1.5612, expected_regret: 4.4191 expected_RLHFobj: 3.9989, reward_accuracy: 0.3800
Iteration:  99, train_loss:  2747940.9947, valid_loss:  68871639.5866, grad_norm :44.1176, param_norm: 1.0199, expected_regret: 3.6291 expected_RLHFobj: 1.9031, reward_accuracy: 0.4200
Iteration:  199, train_loss:  2747759.9755, valid_loss:  68928869.4002, grad_norm :56.3105, param_norm: 1.0004, expected_regret: 3.7238 expected_RLHFobj: 1.8353, reward_accuracy: 0.4100
Iteration:  299, train_loss:  2745339.9896, valid_loss:  68814095.1338, grad_norm :41.5674, param_norm: 0.9883, expected_regret: 3.6370 expected_RLHFobj: 1.8773, reward_accuracy: 0.4400
Iteration:  399, train_loss:  2742773.1480, valid_loss:  68820702.9407, grad_norm :54.1137, param_norm: 0.9744, expected_regret: 3.5584 expected_RLHFobj: 1.8064, reward_accuracy: 0.4500
Iteration:  499, train_loss:  2741494.8708, valid_loss:  68787241.2518, grad_norm :46.8917, param_norm: 0.9595, expected_regret: 3.4522 expected_RLHFobj: 1.7703, reward_accuracy: 0.4600
Iteration:  599, train_loss:  2741009.2218, valid_loss:  68860200.1045, grad_norm :22.1814, param_norm: 0.9453, expected_regret: 3.3366 expected_RLHFobj: 1.7257, reward_accuracy: 0.4600
Iteration:  699, train_loss:  2739642.5843, valid_loss:  68629921.3056, grad_norm :52.2207, param_norm: 0.9371, expected_regret: 3.6564 expected_RLHFobj: 1.8441, reward_accuracy: 0.4100
Iteration:  799, train_loss:  2738617.6221, valid_loss:  68599211.2961, grad_norm :36.3108, param_norm: 0.9280, expected_regret: 3.6193 expected_RLHFobj: 1.8340, reward_accuracy: 0.4100
Iteration:  899, train_loss:  2736976.3445, valid_loss:  68614206.8137, grad_norm :79.4493, param_norm: 0.9185, expected_regret: 3.5999 expected_RLHFobj: 1.8037, reward_accuracy: 0.4400
Iteration:  999, train_loss:  2737806.4771, valid_loss:  68580339.9696, grad_norm :75.9280, param_norm: 0.9092, expected_regret: 3.1964 expected_RLHFobj: 1.7602, reward_accuracy: 0.4700
Logging to logs/exp2_tv/sigmoid_g1.0/2024-11-26-12-57-54/sigmoidloss_2022
Seed:2022
reset state dist uniform
Dataset loaded: ./datasets/exp1.pkl
opt_params: (100, 8) | train_data: (2000, 7) | valid_data: (10000, 7)
Iteration:  0, train_loss:  7473625.6555, valid_loss:  178031404.3908, grad_norm :120.8914, param_norm: 2.0932, expected_regret: 5.2512 expected_RLHFobj: 4.8787, reward_accuracy: 0.3500
Iteration:  99, train_loss:  2867976.6469, valid_loss:  73163302.8413, grad_norm :52.8461, param_norm: 1.6143, expected_regret: 3.5440 expected_RLHFobj: 2.2477, reward_accuracy: 0.4600
Iteration:  199, train_loss:  2846895.2070, valid_loss:  72766032.3261, grad_norm :72.4983, param_norm: 1.5674, expected_regret: 3.5620 expected_RLHFobj: 2.1254, reward_accuracy: 0.4600
Iteration:  299, train_loss:  2843747.9123, valid_loss:  72534135.2381, grad_norm :34.2015, param_norm: 1.5273, expected_regret: 3.5620 expected_RLHFobj: 2.1508, reward_accuracy: 0.4100
Iteration:  399, train_loss:  2832731.1321, valid_loss:  72091287.0735, grad_norm :53.2121, param_norm: 1.4900, expected_regret: 3.5620 expected_RLHFobj: 2.1831, reward_accuracy: 0.4600
Iteration:  499, train_loss:  2827095.2270, valid_loss:  71998629.6188, grad_norm :18.7643, param_norm: 1.4563, expected_regret: 3.5755 expected_RLHFobj: 2.1452, reward_accuracy: 0.4300
Iteration:  599, train_loss:  2819563.4058, valid_loss:  71807197.1120, grad_norm :46.8181, param_norm: 1.4267, expected_regret: 3.5620 expected_RLHFobj: 2.0399, reward_accuracy: 0.4800
Iteration:  699, train_loss:  2815466.4505, valid_loss:  71670915.7685, grad_norm :22.1953, param_norm: 1.3999, expected_regret: 3.5620 expected_RLHFobj: 2.0215, reward_accuracy: 0.4800
Iteration:  799, train_loss:  2810474.3766, valid_loss:  71446381.8644, grad_norm :52.0793, param_norm: 1.3744, expected_regret: 3.5620 expected_RLHFobj: 2.0726, reward_accuracy: 0.4400
Iteration:  899, train_loss:  2806753.1467, valid_loss:  71350203.7068, grad_norm :41.4551, param_norm: 1.3513, expected_regret: 3.5620 expected_RLHFobj: 2.0284, reward_accuracy: 0.4700
Iteration:  999, train_loss:  2803561.6854, valid_loss:  71199543.4039, grad_norm :57.8389, param_norm: 1.3280, expected_regret: 3.5620 expected_RLHFobj: 2.0293, reward_accuracy: 0.4700
Logging to logs/exp2_tv/sigmoid_g1.0/2024-11-26-12-57-54/sigmoidloss_2023
Seed:2023
reset state dist uniform
Dataset loaded: ./datasets/exp1.pkl
opt_params: (100, 8) | train_data: (2000, 7) | valid_data: (10000, 7)
Iteration:  0, train_loss:  5082109.2436, valid_loss:  128791995.6933, grad_norm :158.1599, param_norm: 1.2923, expected_regret: 2.6441 expected_RLHFobj: 2.4613, reward_accuracy: 0.5200
Iteration:  99, train_loss:  2761083.9493, valid_loss:  69842855.7103, grad_norm :40.4235, param_norm: 0.9933, expected_regret: 3.5058 expected_RLHFobj: 1.8549, reward_accuracy: 0.4800
Iteration:  199, train_loss:  2757740.9551, valid_loss:  69645822.4533, grad_norm :79.9679, param_norm: 0.9560, expected_regret: 3.5755 expected_RLHFobj: 1.8874, reward_accuracy: 0.4200
Iteration:  299, train_loss:  2751353.9928, valid_loss:  69418932.2053, grad_norm :49.2235, param_norm: 0.9271, expected_regret: 3.6628 expected_RLHFobj: 1.8607, reward_accuracy: 0.4500
Iteration:  399, train_loss:  2749832.3401, valid_loss:  69417335.4565, grad_norm :47.0476, param_norm: 0.9037, expected_regret: 3.3587 expected_RLHFobj: 1.8157, reward_accuracy: 0.4600
Iteration:  499, train_loss:  2749054.3097, valid_loss:  69450057.3098, grad_norm :59.6248, param_norm: 0.8845, expected_regret: 3.3999 expected_RLHFobj: 1.7621, reward_accuracy: 0.4800
Iteration:  599, train_loss:  2747429.5419, valid_loss:  69340968.3577, grad_norm :42.3531, param_norm: 0.8631, expected_regret: 3.6103 expected_RLHFobj: 1.8302, reward_accuracy: 0.4400
Iteration:  699, train_loss:  2743686.3936, valid_loss:  69173074.9215, grad_norm :57.8895, param_norm: 0.8461, expected_regret: 3.5999 expected_RLHFobj: 1.8284, reward_accuracy: 0.4500
Iteration:  799, train_loss:  2742107.3108, valid_loss:  69146522.2636, grad_norm :50.9202, param_norm: 0.8278, expected_regret: 3.5681 expected_RLHFobj: 1.7977, reward_accuracy: 0.4600
Iteration:  899, train_loss:  2740760.8560, valid_loss:  69064995.0865, grad_norm :71.9726, param_norm: 0.8137, expected_regret: 3.3166 expected_RLHFobj: 1.8016, reward_accuracy: 0.4500
Iteration:  999, train_loss:  2739225.0062, valid_loss:  69028893.1811, grad_norm :44.9686, param_norm: 0.7970, expected_regret: 3.6628 expected_RLHFobj: 1.8010, reward_accuracy: 0.4400
Logging to logs/exp2_tv/sigmoid_g1.0/2024-11-26-12-57-54/sigmoidloss_2024
Seed:2024
reset state dist uniform
Dataset loaded: ./datasets/exp1.pkl
opt_params: (100, 8) | train_data: (2000, 7) | valid_data: (10000, 7)
Iteration:  0, train_loss:  5860748.7860, valid_loss:  142669182.4809, grad_norm :145.5136, param_norm: 1.3613, expected_regret: 4.5459 expected_RLHFobj: 3.8601, reward_accuracy: 0.3500
Iteration:  99, train_loss:  2743168.2211, valid_loss:  69199230.7785, grad_norm :41.4989, param_norm: 0.9865, expected_regret: 3.5145 expected_RLHFobj: 1.8207, reward_accuracy: 0.4300
Iteration:  199, train_loss:  2740608.6588, valid_loss:  69138358.3468, grad_norm :40.8340, param_norm: 0.9706, expected_regret: 3.4427 expected_RLHFobj: 1.8183, reward_accuracy: 0.4400
Iteration:  299, train_loss:  2737344.6983, valid_loss:  68934273.6269, grad_norm :16.2346, param_norm: 0.9537, expected_regret: 3.6531 expected_RLHFobj: 1.8579, reward_accuracy: 0.4200
Iteration:  399, train_loss:  2737071.4504, valid_loss:  68935430.3678, grad_norm :22.9504, param_norm: 0.9376, expected_regret: 3.6628 expected_RLHFobj: 1.7929, reward_accuracy: 0.4600
Iteration:  499, train_loss:  2736526.1645, valid_loss:  69028169.3189, grad_norm :68.5337, param_norm: 0.9263, expected_regret: 3.4054 expected_RLHFobj: 1.7625, reward_accuracy: 0.4400
Iteration:  599, train_loss:  2734168.2881, valid_loss:  68801765.7093, grad_norm :36.1645, param_norm: 0.9162, expected_regret: 3.5999 expected_RLHFobj: 1.8786, reward_accuracy: 0.4200
Iteration:  699, train_loss:  2734120.2525, valid_loss:  68859858.5534, grad_norm :60.2086, param_norm: 0.9070, expected_regret: 3.5164 expected_RLHFobj: 1.8435, reward_accuracy: 0.4400
Iteration:  799, train_loss:  2732542.1128, valid_loss:  68824802.4741, grad_norm :32.5631, param_norm: 0.8972, expected_regret: 3.5999 expected_RLHFobj: 1.8253, reward_accuracy: 0.4200
Iteration:  899, train_loss:  2731662.3435, valid_loss:  68716829.1338, grad_norm :31.4378, param_norm: 0.8890, expected_regret: 3.6531 expected_RLHFobj: 1.8471, reward_accuracy: 0.3900
Iteration:  999, train_loss:  2730868.9153, valid_loss:  68748663.7271, grad_norm :56.8257, param_norm: 0.8817, expected_regret: 3.5164 expected_RLHFobj: 1.8027, reward_accuracy: 0.4400
Logging to logs/exp2_tv/sigmoid_g1.0/2024-11-26-12-57-54/sigmoidloss_2025
Seed:2025
reset state dist uniform
Dataset loaded: ./datasets/exp1.pkl
opt_params: (100, 8) | train_data: (2000, 7) | valid_data: (10000, 7)
Iteration:  0, train_loss:  5403259.8805, valid_loss:  130512324.4475, grad_norm :137.0502, param_norm: 1.7728, expected_regret: 4.9318 expected_RLHFobj: 4.2778, reward_accuracy: 0.3400
Iteration:  99, train_loss:  2829143.2295, valid_loss:  72050497.9250, grad_norm :31.9242, param_norm: 1.4940, expected_regret: 3.5755 expected_RLHFobj: 2.0816, reward_accuracy: 0.4700
Iteration:  199, train_loss:  2817781.0488, valid_loss:  71617308.0206, grad_norm :48.6658, param_norm: 1.4412, expected_regret: 3.5755 expected_RLHFobj: 2.1485, reward_accuracy: 0.4400
Iteration:  299, train_loss:  2812406.5346, valid_loss:  71515797.4855, grad_norm :29.9254, param_norm: 1.3966, expected_regret: 3.5755 expected_RLHFobj: 2.0136, reward_accuracy: 0.4500
Iteration:  399, train_loss:  2803629.8905, valid_loss:  71160683.0074, grad_norm :32.7226, param_norm: 1.3597, expected_regret: 3.5755 expected_RLHFobj: 2.0332, reward_accuracy: 0.5000
Iteration:  499, train_loss:  2798025.8596, valid_loss:  71038649.7954, grad_norm :44.1296, param_norm: 1.3270, expected_regret: 3.5620 expected_RLHFobj: 2.0043, reward_accuracy: 0.4600
Iteration:  599, train_loss:  2794651.5994, valid_loss:  70897354.8018, grad_norm :66.3372, param_norm: 1.2990, expected_regret: 3.5755 expected_RLHFobj: 2.0158, reward_accuracy: 0.4400
Iteration:  699, train_loss:  2789515.8489, valid_loss:  70808740.2406, grad_norm :39.2359, param_norm: 1.2711, expected_regret: 3.5145 expected_RLHFobj: 1.8981, reward_accuracy: 0.4900
Iteration:  799, train_loss:  2787063.4685, valid_loss:  70642468.1380, grad_norm :40.2712, param_norm: 1.2481, expected_regret: 3.5620 expected_RLHFobj: 1.8961, reward_accuracy: 0.5000
Iteration:  899, train_loss:  2782040.2865, valid_loss:  70495142.2845, grad_norm :41.0388, param_norm: 1.2256, expected_regret: 3.5755 expected_RLHFobj: 1.9396, reward_accuracy: 0.4500
Iteration:  999, train_loss:  2779927.5405, valid_loss:  70463412.5407, grad_norm :24.3058, param_norm: 1.2036, expected_regret: 3.4723 expected_RLHFobj: 1.8850, reward_accuracy: 0.4800
